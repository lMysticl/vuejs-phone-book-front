webpackJsonp([1],{0:function(e,t){},"7zck":function(e,t){},FbqU:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("7+uW"),s={props:{modal:Boolean},data:function(){return{credentials:{username:null,password:null},error:!1,errorMessage:null}},methods:{close:function(){this.$emit("close")},clearError:function(){this.errorMessage=null},login:function(){var e=this,t=new FormData;t.append("grant_type","password"),t.append("username",this.credentials.username),t.append("password",this.credentials.password),this.$store.dispatch("login",{credentials:this.credentials,formData:t,redirect:"test"}).then(function(){console.log("Login was successful!!!!!!!"),e.close()}).catch(function(t){e.error=!0,e.errorMessage=t.body.error_description})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("Login")])]),e._v(" "),a("v-divider"),e._v(" "),a("v-alert",{attrs:{type:"error",dismissible:"",transition:"scale-transition"},on:{input:e.clearError},model:{value:e.error,callback:function(t){e.error=t},expression:"error"}},[e._v("\n        "+e._s(e.errorMessage)+"\n      ")]),e._v(" "),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{id:"username",label:"Username",required:"","prepend-icon":"perm_identity"},model:{value:e.credentials.username,callback:function(t){e.$set(e.credentials,"username",t)},expression:"credentials.username"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{id:"password",label:"Password",required:"",type:"password","prepend-icon":"lock_open"},model:{value:e.credentials.password,callback:function(t){e.$set(e.credentials,"password",t)},expression:"credentials.password"}})],1)],1)],1),e._v(" "),a("small",[e._v("*indicates required field")])],1),e._v(" "),a("v-divider"),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},on:{click:e.close}},[e._v("close")]),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},on:{click:e.login}},[e._v("login")])],1)],1)],1)],1)},staticRenderFns:[]},i=a("VU/8")(s,o,!1,null,null,null).exports,r={props:{modal:Boolean},data:function(){return{register:{},error:!1,errorMessage:null}},methods:{close:function(){this.$emit("close")},clearError:function(){this.errorMessage=null},registration:function(){var e=this;this.$store.dispatch("registration",{data:this.register}).then(function(){console.log("Registration was successful!!!!!!!"),e.close()}).catch(function(t){e.error=!0,e.errorMessage=t.body.error_description})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("Registration")])]),e._v(" "),a("v-divider"),e._v(" "),a("v-alert",{attrs:{type:"error",dismissible:"",transition:"scale-transition"},on:{input:e.clearError},model:{value:e.error,callback:function(t){e.error=t},expression:"error"}},[e._v("\n        "+e._s(e.errorMessage)+"\n      ")]),e._v(" "),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{id:"reg_username",label:"Username","prepend-icon":"perm_identity"},model:{value:e.register.username,callback:function(t){e.$set(e.register,"username",t)},expression:"register.username"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{id:"firstname",label:"First name*","prepend-icon":"lock_open"},model:{value:e.register.firstname,callback:function(t){e.$set(e.register,"firstname",t)},expression:"register.firstname"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{id:"reg_password",label:"Password",type:"password","prepend-icon":"lock_open"},model:{value:e.register.password,callback:function(t){e.$set(e.register,"password",t)},expression:"register.password"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{id:"middlename",label:"Middle name*","prepend-icon":"lock_open"},model:{value:e.register.middlename,callback:function(t){e.$set(e.register,"middlename",t)},expression:"register.middlename"}})],1)],1)],1),e._v(" "),a("small",[e._v("*indicates required field")])],1),e._v(" "),a("v-divider"),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},on:{click:e.close}},[e._v("close")]),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},on:{click:e.registration}},[e._v("registration")])],1)],1)],1)],1)},staticRenderFns:[]},c={components:{appLogin:i,appRegistration:a("VU/8")(r,l,!1,null,null,null).exports},data:function(){return{login:!1,register:!1}},methods:{openLoginModal:function(){this.login=!0},closeRegisterModal:function(){this.register=!1},openRegisterModal:function(){this.register=!0},closeLoginModal:function(){this.login=!1},logOut:function(){this.$store.dispatch("logOut")},toTestPage:function(){this.isAuth?this.$router.push("/test"):this.openLoginModal()}},computed:{todayYear:function(){return(new Date).getFullYear()},isAuth:function(){return this.$store.getters.isAuth}},name:"App",watch:{isAuth:function(e){e&&(this.login=!1)}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-toolbar",{attrs:{app:""}},[a("v-toolbar-items",[a("v-btn",{attrs:{exact:"",flat:"",to:"/"}},[e._v("\n        Phone Book\n      ")]),e._v(" "),a("v-btn",{attrs:{exact:"",flat:""},on:{click:e.toTestPage}},[e._v("\n        Test Page\n      ")])],1),e._v(" "),a("v-spacer"),e._v(" "),a("v-toolbar-items",[e.isAuth?e._e():a("v-btn",{attrs:{flat:""},on:{click:e.openRegisterModal}},[a("v-icon",{attrs:{left:""}},[e._v("account_circle")]),e._v("\n        Registration\n      ")],1),e._v(" "),e.isAuth?e._e():a("v-btn",{attrs:{flat:""},on:{click:e.openLoginModal}},[a("v-icon",{attrs:{left:""}},[e._v("account_circle")]),e._v("\n        Login\n      ")],1),e._v(" "),e.isAuth?a("v-btn",{attrs:{flat:""},on:{click:e.logOut}},[a("v-icon",{attrs:{left:""}},[e._v("account_circle")]),e._v("\n        LogOut\n      ")],1):e._e()],1)],1),e._v(" "),a("v-content",[a("router-view")],1),e._v(" "),a("app-login",{attrs:{modal:e.login},on:{close:e.closeLoginModal}}),e._v(" "),a("app-registration",{attrs:{modal:e.register},on:{close:e.closeRegisterModal}}),e._v(" "),a("v-footer",{attrs:{app:""}},[a("span",[e._v("Â© "+e._s(e.todayYear))])])],1)},staticRenderFns:[]},u=a("VU/8")(c,d,!1,null,null,null).exports,v=a("/ocq");function m(e){return function(e){var t=e.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(window.atob(t))}(e).exp}function h(){return localStorage.getItem("access_token")}var p={getToken:h,saveToken:function(e){localStorage.setItem("access_token",e)},deleteToken:function(){localStorage.removeItem("access_token")},getAuthHeader:function(){return"Bearer "+h()},isTokenExpired:function(){var e=h();return!e||Date.now()/1e3>m(e)}},f=a("fZjL"),_=a.n(f),x={props:["contact"],data:function(){return{modal:!1,contactId:null,firstname:null,middlename:null,lastname:null,address:null,email:null,homePhone:null,mobilePhone:null}},methods:{setValues:function(){this.contactId=this.contact.contactId,this.firstname=this.contact.firstname,this.middlename=this.contact.middlename,this.lastname=this.contact.lastname,this.address=this.contact.address,this.email=this.contact.email,this.homePhone=this.contact.homePhone,this.mobilePhone=this.contact.mobilePhone},close:function(){this.modal=!1},open:function(){this.modal=!0},save:function(){var e=this,t=new FormData;t.append("contactId",this.contactId),t.append("firstname",this.firstname),t.append("lastname",this.lastname),t.append("middlename",this.middlename),t.append("address",this.address),t.append("email",this.email),t.append("homePhone",this.homePhone),t.append("mobilePhone",this.mobilePhone),this.$http.post("https://vuejs-phone-book.herokuapp.com/contacts/update",t,{headers:{Authorization:p.getAuthHeader()}}).then(function(){e.close(),e.$emit("update"),console.log("Contact has been updated")})}},watch:{contact:function(e){_()(e).length&&(this.open(),this.setValues())}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{persistent:"",scrollable:"","max-width":"450px"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("Contact data")])]),e._v(" "),a("v-divider"),e._v(" "),a("v-card-text",{staticStyle:{"max-height":"400px"}},[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"First name"},model:{value:e.firstname,callback:function(t){e.firstname=t},expression:"firstname"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Last name"},model:{value:e.lastname,callback:function(t){e.lastname=t},expression:"lastname"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Middle name"},model:{value:e.middlename,callback:function(t){e.middlename=t},expression:"middlename"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Mobile phone"},model:{value:e.mobilePhone,callback:function(t){e.mobilePhone=t},expression:"mobilePhone"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Home phone"},model:{value:e.homePhone,callback:function(t){e.homePhone=t},expression:"homePhone"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Address"},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Email"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1)],1)],1)],1),e._v(" "),a("v-divider"),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(t){e.modal=!1}}},[e._v("Close")]),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(t){e.save(t)}}},[e._v("Save")])],1)],1)],1)},staticRenderFns:[]};var b={data:function(){return{modal:!1,firstname:null,middlename:null,lastname:null,address:null,email:null,homePhone:null,mobilePhone:null}},methods:{close:function(){this.modal=!1},clean:function(){this.firstname=null,this.lastname=null,this.middlename=null,this.address=null,this.email=null,this.homePhone=null,this.mobilePhone=null},open:function(){this.modal=!0},save:function(){var e=this,t=new FormData;t.append("firstname",this.firstname),t.append("lastname",this.lastname),t.append("middlename",this.middlename),t.append("address",this.address),t.append("email",this.email),t.append("homePhone",this.homePhone),t.append("mobilePhone",this.mobilePhone),this.$http.post("https://vuejs-phone-book.herokuapp.com/contacts/add",t,{headers:{Authorization:p.getAuthHeader()}}).then(function(){e.close(),e.$emit("update"),e.clean(),console.log("Contact has been added")})}}},k={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{persistent:"",scrollable:"","max-width":"450px"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[a("v-btn",{attrs:{slot:"activator",flat:"",color:"blue",dark:""},slot:"activator"},[e._v("new contact")]),e._v(" "),a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("Contact data")])]),e._v(" "),a("v-divider"),e._v(" "),a("v-card-text",{staticStyle:{"max-height":"400px"}},[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"First name"},model:{value:e.firstname,callback:function(t){e.firstname=t},expression:"firstname"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Last name"},model:{value:e.lastname,callback:function(t){e.lastname=t},expression:"lastname"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Middle name"},model:{value:e.middlename,callback:function(t){e.middlename=t},expression:"middlename"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Mobile phone"},model:{value:e.mobilePhone,callback:function(t){e.mobilePhone=t},expression:"mobilePhone"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Home phone"},model:{value:e.homePhone,callback:function(t){e.homePhone=t},expression:"homePhone"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Address"},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Email"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1)],1)],1)],1),e._v(" "),a("v-divider"),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(t){e.modal=!1}}},[e._v("Close")]),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(t){e.save(t)}}},[e._v("Save")])],1)],1)],1)},staticRenderFns:[]};var w="https://vuejs-phone-book.herokuapp.com/",P={components:{contactEdit:a("VU/8")(x,g,!1,function(e){a("gELo")},"data-v-759b1fce",null).exports,contactAdd:a("VU/8")(b,k,!1,function(e){a("wC7v")},"data-v-5fc9a8a0",null).exports},data:function(){return{contact:{},loading:!1,selected:[],search:null,pagination:{rowsPerPage:10},headers:[{text:"ID",align:"left",value:"contactId"},{text:"First Name",value:"firstname"},{text:"Last Name",value:"lastname"},{text:"Middle Name",value:"middlename"},{text:"Mobile Name",value:"mobilePhone"},{text:"Home phone",value:"homePhone"},{text:"Address",value:"address"},{text:"Email",value:"email"},{text:"Actions",value:"name",sortable:!1}],contacts:[]}},created:function(){this.loadContactList()},methods:{loadContactList:function(){var e=this;this.loading=!0,this.$http.get(w+"contacts/get-all",{headers:{Authorization:p.getAuthHeader()}}).then(function(t){e.contacts=t.body,e.loading=!1})},selectContact:function(e){this.contact=this.contacts.find(function(t){return t.contactId===e})},deleteContact:function(e){var t=this,a=new FormData;a.append("contactId",e),this.$http.post(w+"contacts/delete",a,{headers:{Authorization:p.getAuthHeader()}}).then(function(){t.selected=[],t.loadContactList()})},deleteSelectedContacts:function(){var e=this,t=new FormData,a=this.selected.map(function(e){return e.contactId});t.append("contactId",a),console.log(t.getAll("contactId")),this.$http.post(w+"contacts/deleteList",t,{headers:{Authorization:p.getAuthHeader()}}).then(function(){e.selected=[],e.loadContactList()})}},computed:{pages:function(){return null==this.pagination.rowsPerPage||null==this.pagination.totalItems?0:Math.ceil(this.contacts.length/this.pagination.rowsPerPage)}}},A={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{"justify-center":""}},[a("v-flex",{staticClass:"pt-5",staticStyle:{"max-width":"1250px"}},[a("v-card",[a("v-card-actions",[a("contact-add",{on:{update:e.loadContactList}}),e._v(" "),e.selected.length?a("v-btn",{on:{click:e.deleteSelectedContacts}},[e._v("Delete selected")]):e._e(),e._v(" "),a("v-spacer"),e._v(" "),a("v-text-field",{attrs:{box:"",label:"Search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),a("v-data-table",{attrs:{loading:e.loading,headers:e.headers,items:e.contacts,search:e.search,"select-all":"","item-key":"contactId",pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"items",fn:function(t){return[a("tr",[a("td",[a("v-checkbox",{attrs:{primary:"","hide-details":""},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"props.selected"}})],1),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.contactId))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.firstname))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.lastname))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.middlename))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.mobilePhone))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.homePhone))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.address))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.email))]),e._v(" "),a("td",{staticClass:"justify-center layout px-0"},[a("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(a){e.selectContact(t.item.contactId)}}},[a("v-icon",{attrs:{color:"teal"}},[e._v("edit")])],1),e._v(" "),a("v-btn",{staticClass:"mx-0",attrs:{icon:""},on:{click:function(a){e.deleteContact(t.item.contactId)}}},[a("v-icon",{attrs:{color:"pink"}},[e._v("delete")])],1)],1)])]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1),e._v(" "),a("contact-edit",{attrs:{contact:e.contact},on:{update:e.loadContactList}})],1)],1)],1)},staticRenderFns:[]};var C=a("VU/8")(P,A,!1,function(e){a("FbqU")},null,null).exports,y=a("woOf"),$=a.n(y),M=a("NYxO");n.a.use(M.a);var L=new M.a.Store({state:{user:{},redirect:null,isAuth:!1},getters:{user:function(e){return e.user},isAuth:function(e){return e.isAuth},redirect:function(e){return e.redirect}},mutations:{setUser:function(e,t){return e.user=$()({},t)},setRedirect:function(e,t){e.redirect=t},setAuth:function(e,t){e.isAuth=t}},actions:{login:function(e,t){var a,s=e.commit,o=(t.credentials,t.formData),i=t.redirect;return n.a.http.post("https://vuejs-phone-book.herokuapp.com/oauth/token",o,{headers:{authorization:"Basic "+(a="testjwtclientid:XY7kmzoNzl100",btoa(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)})))}}).then(function(e){var t=e.body.access_token;return p.saveToken(t),s("setAuth",!0),i&&E.push(i),!0})},registration:function(e,t){e.commit,t.credentials;var a=t.data,s=t.redirect;return n.a.http.post("https://vuejs-phone-book.herokuapp.com/api/register",a).then(function(e){return s&&E.push(s),!0})},logOut:function(e){var t=e.commit;p.deleteToken(),t("setAuth",!1),E.push("/")}}});n.a.use(v.a);var I=new v.a({mode:"history",routes:[{path:"/test",component:C,meta:{requireAuth:!0}}]});I.beforeEach(function(e,t,a){var n=e.matched.some(function(e){return e.meta.requireAuth});L.getters.isAuth;p.isTokenExpired()?(p.deleteToken(),L.commit("setAuth",!1)):(L.commit("setAuth",!0),a()),!L.getters.isAuth&&n?a("/"):a()});var E=I,F=a("3EgV"),R=a.n(F),S=a("8+8L");a("7zck");n.a.use(R.a),n.a.use(S.a),n.a.config.productionTip=!1,new n.a({el:"#app",router:E,store:L,components:{App:u},template:"<App/>"})},gELo:function(e,t){},wC7v:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.b408194b41523e88d4d2.js.map